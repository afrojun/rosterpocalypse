= page_title "Roster Status: #{@roster.name}#{@gameweek.present? ? " : #{@gameweek.name}" : ""}"

.roster-status-header
  %span.col-xs-2.roster-status-gameweek-navigation
    - if @gameweek.previous.present?
      = link_to "Previous", status_roster_path(@roster, gameweek: @gameweek.previous)
  %span.col-xs-8.roster-status-heading= @gameweek.name

  %span.col-xs-2.roster-status-gameweek-navigation.float-sm-right
    - if @gameweek.next.present?
      = link_to "Next", status_roster_path(@roster, gameweek: @gameweek.next)

.roster-status-gameweek-summary

.roster-status-team-details
  - @gameweek_players_by_player.each do |player, gameweek_player|
    .col-xs-4.roster-status-player-details
      .col-xs-6
        .roster-status-player-name= player.name
        .roster-status-player-team= gameweek_player.present? ? gameweek_player.team.name : player.team.name
      - if gameweek_player.present?
        .col-xs-6.float.sm-right
          .roster-status-player-points= gameweek_player.points
        .col-xs-12.roster-status-player-game-details
          - gameweek_player.points_breakdowns_by_game.each do |game, points_breakdown|
            - player_game_detail = game.game_details.where(player: player).first

            .col-xs-10.roster-status-player-game-details-map{id: "#{player.id}-#{game.id}"}= "vs. #{game.other_team(player_game_detail.team).name} on #{game.map.name}"
            .col-xs-2.roster-status-player-game-details-points= points_breakdown[:total]
            .col-xs-12.roster-status-player-game-details-points-breakdown{id: "game-details-#{player.id}-#{game.id}"}
              %table.table.table-sm
                %thead
                  %tr
                    %th Statistic
                    %th Count
                    %th Points
                %tbody
                  - points_breakdown.except(:bonus, :total).each do |category, points|
                    %tr
                      %td= category.to_s.humanize
                      %td= player_game_detail.try(:send, category)
                      %td= points
              .roster-status-player-game-details-bonus
                - if points_breakdown[:bonus].any?
                  %strong Bonus awards:
                  = points_breakdown[:bonus].map { |bonus| bonus.to_s.humanize }.to_sentence

:javascript
  $(function() {
    $('.roster-status-player-game-details-map').click(function(e){
      var id = e.target.id;
      var game_details_id = "#game-details-" + id
      console.log(game_details_id);
      $(game_details_id).slideToggle('fast');
    });
  })